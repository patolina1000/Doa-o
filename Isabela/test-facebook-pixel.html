<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Facebook Pixel - Campanha Ang√©lica</title>
    
    <!-- Facebook Pixel Code -->
    <script>
        !function (f, b, e, v, n, t, s) {
            if (f.fbq) return; n = f.fbq = function () {
                n.callMethod ?
                    n.callMethod.apply(n, arguments) : n.queue.push(arguments)
            };
            if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
            n.queue = []; t = b.createElement(e); t.async = !0;
            t.src = v; s = b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t, s)
        }(window, document, 'script',
            'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '1513482096307953');
        fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
            src="https://www.facebook.com/tr?id=1513482096307953&amp;ev=PageView&amp;noscript=1" /></noscript>
    
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        button {
            background: #24ca68;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
            font-size: 16px;
        }
        button:hover { background: #20b85e; }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
            margin-top: 15px;
        }
        .pixel-status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .pixel-ok { background: #d4edda; color: #155724; }
        .pixel-error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ Teste Facebook Pixel - Campanha Ang√©lica</h1>
        <p>Esta p√°gina testa todos os eventos do Facebook Pixel implementados.</p>

        <div class="test-section info">
            <h3>üìã Status do Pixel</h3>
            <div id="pixelStatus" class="pixel-status">Verificando...</div>
            <p><strong>Pixel ID:</strong> 1513482096307953</p>
            <p><strong>P√°gina:</strong> Teste Facebook Pixel</p>
        </div>

        <div class="test-section">
            <h3>üß™ Testes Dispon√≠veis</h3>
            <button onclick="testViewContent()">üìÑ Testar ViewContent</button>
            <button onclick="testInitiateCheckout()">üõí Testar InitiateCheckout</button>
            <button onclick="testAddPaymentInfo()">üí≥ Testar AddPaymentInfo</button>
            <button onclick="testPurchase()">üéâ Testar Purchase</button>
            <button onclick="testDonate()">‚ù§Ô∏è Testar Donate</button>
            <button onclick="clearLog()">üßπ Limpar Log</button>
        </div>

        <div class="test-section">
            <h3>üìä Log de Eventos</h3>
            <div id="eventLog" class="log">Aguardando testes...</div>
        </div>
    </div>

    <!-- Facebook Pixel Manager -->
    <script src="js/facebook-pixel-config.js"></script>
    
    <script>
        let eventLog = [];

        // Verificar status do pixel
        function checkPixelStatus() {
            const statusDiv = document.getElementById('pixelStatus');
            
            if (typeof fbq !== 'undefined') {
                statusDiv.className = 'pixel-status pixel-ok';
                statusDiv.textContent = '‚úÖ Facebook Pixel carregado corretamente';
                addLog('‚úÖ Facebook Pixel inicializado com sucesso');
            } else {
                statusDiv.className = 'pixel-status pixel-error';
                statusDiv.textContent = '‚ùå Facebook Pixel n√£o encontrado';
                addLog('‚ùå Erro: Facebook Pixel n√£o carregado');
            }

            if (typeof window.fbPixelManager !== 'undefined') {
                addLog('‚úÖ FacebookPixelManager dispon√≠vel');
            } else {
                addLog('‚ö†Ô∏è FacebookPixelManager n√£o encontrado');
            }
        }

        // Adicionar log
        function addLog(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            eventLog.push(logEntry);
            
            const logElement = document.getElementById('eventLog');
            logElement.textContent = eventLog.join('\n');
            logElement.scrollTop = logElement.scrollHeight;
            
            console.log(logEntry);
        }

        // Testes individuais
        function testViewContent() {
            addLog('üß™ Testando ViewContent...');
            
            if (typeof fbq !== 'undefined') {
                fbq('track', 'ViewContent', {
                    content_type: 'product',
                    content_ids: ['test_donation_campaign'],
                    content_name: 'Teste Campanha Doa√ß√£o',
                    content_category: 'Health/Medical/Donation',
                    value: 0,
                    currency: 'BRL'
                });
                addLog('‚úÖ ViewContent enviado com sucesso');
            } else {
                addLog('‚ùå Erro: fbq n√£o dispon√≠vel');
            }
        }

        function testInitiateCheckout() {
            addLog('üß™ Testando InitiateCheckout...');
            
            if (typeof window.fbPixelManager !== 'undefined') {
                const success = window.fbPixelManager.trackInitiateCheckout(0, {
                    content_name: 'Teste Campanha Doa√ß√£o',
                    source: 'test-button'
                });
                
                if (success) {
                    addLog('‚úÖ InitiateCheckout enviado via FacebookPixelManager');
                } else {
                    addLog('‚ùå Erro no FacebookPixelManager');
                }
            } else if (typeof fbq !== 'undefined') {
                fbq('track', 'InitiateCheckout', {
                    content_category: 'Health/Medical/Donation',
                    content_name: 'Teste Campanha Doa√ß√£o',
                    content_ids: ['test_donation_form'],
                    value: 0,
                    currency: 'BRL'
                });
                addLog('‚úÖ InitiateCheckout enviado via fbq direto');
            } else {
                addLog('‚ùå Erro: Nenhum m√©todo dispon√≠vel');
            }
        }

        function testAddPaymentInfo() {
            addLog('üß™ Testando AddPaymentInfo...');
            
            if (typeof window.fbPixelManager !== 'undefined') {
                const success = window.fbPixelManager.trackAddPaymentInfo(25.00, {
                    payment_method: 'PIX',
                    source: 'test-button'
                });
                
                if (success) {
                    addLog('‚úÖ AddPaymentInfo enviado (R$ 25,00) via FacebookPixelManager');
                } else {
                    addLog('‚ùå Erro no FacebookPixelManager');
                }
            } else if (typeof fbq !== 'undefined') {
                fbq('track', 'AddPaymentInfo', {
                    content_category: 'Health/Medical/Donation',
                    value: 25.00,
                    currency: 'BRL',
                    payment_method: 'PIX'
                });
                addLog('‚úÖ AddPaymentInfo enviado (R$ 25,00) via fbq direto');
            } else {
                addLog('‚ùå Erro: Nenhum m√©todo dispon√≠vel');
            }
        }

        function testPurchase() {
            addLog('üß™ Testando Purchase...');
            
            const testTransactionId = 'test_' + Date.now();
            
            if (typeof window.fbPixelManager !== 'undefined') {
                const success = window.fbPixelManager.trackPurchase(50.00, testTransactionId, {
                    payment_method: 'PIX'
                });
                
                if (success) {
                    addLog(`‚úÖ Purchase enviado (R$ 50,00) - ID: ${testTransactionId}`);
                } else {
                    addLog('‚ùå Erro no Purchase');
                }
            } else {
                addLog('‚ùå FacebookPixelManager n√£o dispon√≠vel');
            }
        }

        function testDonate() {
            addLog('üß™ Testando Donate...');
            
            if (typeof window.fbPixelManager !== 'undefined') {
                const success = window.fbPixelManager.trackDonate(75.00, {
                    campaign: 'Teste Ang√©lica'
                });
                
                if (success) {
                    addLog('‚úÖ Donate enviado (R$ 75,00)');
                } else {
                    addLog('‚ùå Erro no Donate');
                }
            } else {
                addLog('‚ùå FacebookPixelManager n√£o dispon√≠vel');
            }
        }

        function clearLog() {
            eventLog = [];
            document.getElementById('eventLog').textContent = 'Log limpo...';
            addLog('üßπ Log limpo - Pronto para novos testes');
        }

        // Inicializar quando p√°gina carregar
        window.addEventListener('load', function() {
            setTimeout(checkPixelStatus, 1000); // Aguardar 1s para carregar tudo
            addLog('üìÑ P√°gina de teste carregada');
            addLog('üí° Use o Facebook Pixel Helper para verificar os eventos');
        });
    </script>
</body>
</html>
