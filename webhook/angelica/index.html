<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webhook Handler - Ang√©lica</title>
</head>
<body>
    <h1>Webhook Handler</h1>
    <p>Status: <span id="status">Aguardando...</span></p>
    <div id="logs"></div>

    <script>
        // Handler de webhook para Vercel
        async function handleWebhook(request) {
            try {
                const data = await request.json();
                console.log('üì® Webhook recebido:', data);
                
                // Log do webhook
                document.getElementById('status').textContent = 'Webhook recebido!';
                document.getElementById('logs').innerHTML = `
                    <h3>Dados do Webhook:</h3>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
                
                // Processar diferentes tipos de evento
                switch(data.event) {
                    case 'onPixCreated':
                        console.log('‚úÖ PIX criado:', data.transactionId);
                        break;
                    case 'onBuyApproved':
                        console.log('‚úÖ Pagamento aprovado:', data.transactionId);
                        break;
                    case 'onChargeback':
                        console.log('‚ö†Ô∏è Chargeback:', data.transactionId);
                        break;
                    case 'onRefund':
                        console.log('üîÑ Reembolso:', data.transactionId);
                        break;
                    default:
                        console.log('üìù Evento desconhecido:', data.event);
                }
                
                return new Response(JSON.stringify({ success: true }), {
                    status: 200,
                    headers: { 'Content-Type': 'application/json' }
                });
                
            } catch (error) {
                console.error('‚ùå Erro no webhook:', error);
                return new Response(JSON.stringify({ error: error.message }), {
                    status: 500,
                    headers: { 'Content-Type': 'application/json' }
                });
            }
        }

        // Para Vercel Functions (serverless)
        if (typeof module !== 'undefined' && module.exports) {
            module.exports = handleWebhook;
        }

        // Para uso no navegador
        window.handleWebhook = handleWebhook;
    </script>
</body>
</html>
